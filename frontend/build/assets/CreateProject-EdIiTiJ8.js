import{r as l,j as e}from"./index-Mo7RvhfR.js";const b=()=>{const[r,m]=l.useState({title:"",details:"",total_target:"",start_date:"",end_date:"",category:""}),[g,p]=l.useState([]),[i,h]=l.useState(""),[j,x]=l.useState(""),[d,o]=l.useState(""),[u,f]=l.useState([]);l.useEffect(()=>{const a=localStorage.getItem("access_token");a?x(a):(o("Please log in to create a project"),setTimeout(()=>window.location.href="/login",2e3)),fetch("http://localhost:8000/api/categories/").then(t=>t.json()).then(t=>{f(t.results)}).catch(t=>{console.error("Error fetching categories:",t),o("Failed to load categories")})},[]);const n=a=>{m(t=>({...t,[a.target.name]:a.target.value}))},y=a=>{p(t=>[...t,...Array.from(a.target.files)])},v=async a=>{if(a.preventDefault(),!r.category){o("Please select a category");return}if(!i.trim()){o("Please enter at least one tag");return}const t=new FormData;t.append("title",r.title),t.append("details",r.details),t.append("total_target",r.total_target),t.append("start_date",r.start_date),t.append("end_date",r.end_date),t.append("category",r.category);const N=i.split(",").map(s=>s.trim());t.append("tags",N.join(",")),g.forEach(s=>{t.append("images",s)}),console.log("FormData contents:");for(let[s,c]of t.entries())console.log(`${s}: ${c}`);try{const s=await fetch("http://localhost:8000/api/projects/create/",{method:"POST",headers:{Authorization:`Bearer ${j}`},body:t}),c=await s.json();s.ok?(o("Project created successfully!"),console.log("Success response:",c),m({title:"",details:"",total_target:"",start_date:"",end_date:"",category:""}),h(""),p([])):(o("Error creating project: "+JSON.stringify(c)),console.error("Error response:",c))}catch(s){console.error("Network error:",s),o("Network error: "+s.message)}};return e.jsx("section",{className:"container-fluid background-color",children:e.jsx("section",{className:"container pt-5 create-project",children:e.jsxs("div",{className:"card shadow my-create-campaign-style",children:[e.jsx("div",{className:"column-1",children:e.jsx("img",{src:"/Frame6.svg",alt:"create project page image"})}),e.jsx("div",{className:"card-body column-2",children:e.jsxs("form",{onSubmit:v,encType:"multipart/form-data",children:[e.jsx("h2",{children:"Create New Project"}),d&&e.jsx("p",{style:{color:d.includes("successfully")?"green":"red"},children:d}),e.jsxs("div",{className:"form-input",children:[e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",name:"title",placeholder:"Title",className:"form-control",value:r.title,onChange:n,required:!0}),e.jsx("label",{htmlFor:"title",children:"Title"})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{name:"details",placeholder:"Details",className:"form-control",value:r.details,onChange:n,required:!0}),e.jsx("label",{htmlFor:"details",children:"Details"})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"number",name:"total_target",placeholder:"Total Target",className:"form-control",value:r.total_target,onChange:n,required:!0}),e.jsx("label",{htmlFor:"total_target",children:"Total Target"})]}),e.jsxs("div",{className:"date-inputs",children:[e.jsxs("div",{className:"form-floating start-date",children:[e.jsx("input",{type:"date",name:"start_date",className:"form-control",value:r.start_date,onChange:n,required:!0}),e.jsx("label",{htmlFor:"start_date",children:"Start Date"})]}),e.jsxs("div",{className:"form-floating end-date",children:[e.jsx("input",{type:"date",name:"end_date",className:"form-control",value:r.end_date,onChange:n,required:!0}),e.jsx("label",{htmlFor:"end_date",children:"End Date"})]}),e.jsxs("div",{className:"form-floating category",children:[e.jsxs("select",{name:"category",className:"form-select",value:r.category,onChange:n,required:!0,children:[e.jsx("option",{value:"",children:"Select a Category"}),Array.isArray(u)&&u.map(a=>e.jsx("option",{value:a.name,children:a.name},a.name))]}),e.jsx("label",{htmlFor:"category",children:"Category"})]})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",value:i,className:"form-control",onChange:a=>h(a.target.value),placeholder:"Tags (comma separated)"}),e.jsx("label",{children:"Tags (comma separated)"})]}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:y}),e.jsx("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:g.map((a,t)=>e.jsx("img",{src:URL.createObjectURL(a),alt:`preview-${t}`,style:{width:"100px",height:"100px",objectFit:"cover"}},t))}),e.jsx("button",{className:"btn btn-primary w-100 mb-3",type:"submit",children:"Create"})]})]})})]})})})};export{b as default};
